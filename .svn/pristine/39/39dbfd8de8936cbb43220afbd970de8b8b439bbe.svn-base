<ion-header>
    <ion-navbar *ngIf="isIos">
        <ion-row>
            <ion-col width-50>
                <div text-center>
                    <div class="ios-title">
                        Task History
                    </div>
                </div>
            </ion-col>


        </ion-row>
    </ion-navbar>
    <ion-navbar *ngIf="!isIos">
        <ion-row>
            <ion-title>Task History</ion-title>
        </ion-row>
    </ion-navbar>

</ion-header>


<ion-content footer>

    <ion-card class="card-border">
        <ion-card-header class="task-card-header">
            Task Details
        </ion-card-header>
        <ion-card-content>
            <div class="task-card-content">
                <ion-list no-padding text-wrap>
                    <ion-item no-padding text-wrap>
                        <h4 class="text-info capitalize">
                            {{task_description}}</h4>
                        <h5 class="s-time">
                            Start Time:
                            <span>{{updatedTime | date: 'shortTime'}}</span>
                        </h5>
                    </ion-item>

                    <div *ngIf="additional_notes?.length > 0">
                        <h5 class="text-info">Additional Task Notes</h5>
                        <ion-item no-padding text-wrap
                                  *ngFor="let newNotes of additional_notes; let u = index">
                            <h5 class="add_notes">{{u + 1}}: {{newNotes.notes}}</h5>
                            <h5 class="add_by">Added By: <strong>{{newNotes.employee.first_name}}
                                {{newNotes.employee.last_name}}</strong> at
                                <span *ngIf="isIos">{{adjustTime(newNotes.updatedTime) }}</span>
                                <span *ngIf="!isIos">{{newNotes.updatedTime | date: 'shortTime'}}</span>
                            </h5>
                        </ion-item>
                    </div>
                </ion-list>
            </div>
        </ion-card-content>
    </ion-card>

    <ion-card class="card-border">
        <ion-card-header class="task-card-header">
            Crew
        </ion-card-header>
        <ion-card-content>
            <div class="task-card-content">
                <ion-row *ngFor="let crewMember of task_crew; let j = index">
                    <ion-col class="margin-left-crew" *ngIf="crewMember.is_supervisor !== 1">
                        <h4 class="crew-font">{{crewMember.first_name}}
                            {{crewMember.last_name}} </h4>
                        <h4 *ngIf="crewMember.is_foreman === 1"> -- Foreman --</h4>
                        <p class="crew-phone">
                            <button ion-button icon-left clear medium
                                    class="phoneNum2"
                                    (click)="callPhone(crewMember.phone)">
                                {{crewMember.phone}}
                            </button>
                        </p>
                    </ion-col>
                </ion-row>
            </div>
        </ion-card-content>
    </ion-card>

    <ion-card class="card-border" *ngIf="contractor_contacts?.length > 0">
        <ion-card-header class="task-card-header">
            Contractor Contacts
        </ion-card-header>
        <ion-card-content>
            <div class="task-card-content">
                <ion-row *ngFor="let contact of contractor_contacts; let k = index">
                    <ion-col class="margin-left-crew">
                        <h4 class="crew-font">{{contact.first_name}}
                            {{contact.last_name}} </h4>
                        <h4 class="contractor-title2"><span class="bold">Title: </span>{{contact.title}}</h4>
                        <p class="crew-phone" *ngIf="contact.office_phone">
                            <button ion-button icon-left clear medium
                                    class="call-contractor"
                                    (click)="callPhone(contact.office_phone)">
                                <span class="contractor-phone">Office: </span> {{contact.office_phone}}
                            </button>
                        </p>
                        <p class="crew-phone" *ngIf="contact.cell_phone">
                            <button ion-button icon-left clear medium
                                    class="call-contractor"
                                    (click)="callPhone(contact.cell_phone)">
                                <span class="contractor-phone">Cell: </span> {{contact.cell_phone}}
                            </button>
                        </p>
                    </ion-col>
                </ion-row>
            </div>
        </ion-card-content>
    </ion-card>

    <ion-card class="card-border" *ngIf="task_user_log?.length > 0">
        <ion-card-header class="task-card-header">
            Notes
        </ion-card-header>
        <ion-card-content>
            <div class="task-card-content">
                <div class="equip-div" *ngFor="let note of task_user_log; let l = index">
                    <h5 class="add_notes">{{l + 1}}: {{note.notes}}</h5>
                    <h5 class="add_by">Added At:
                        <span *ngIf="isIos">{{adjustTime(note.updatedTime) }}</span>
                        <span *ngIf="!isIos">{{note.updatedTime | date: 'shortTime'}}</span>
                    </h5>
                </div>
            </div>
        </ion-card-content>
    </ion-card>


    <ion-card class="card-border" *ngIf="task_equipment?.length > 0">
        <ion-card-header class="task-card-header">
            Equipment
        </ion-card-header>
        <ion-card-content>
            <div class="task-card-content">
                <div class="equip-div" *ngFor="let item of task_equipment">
                    <h4 class="equip-name">{{item.equipment_name}}</h4>
                </div>
                <div class="equip-center" *ngIf="task_equipment.length === 0">
                    No Equipment Specified
                </div>
            </div>
        </ion-card-content>
    </ion-card>

    <ion-card class="card-border" *ngIf="task_materials?.length > 0">
        <ion-card-header class="task-card-header">
            Materials/Supplier
        </ion-card-header>
        <ion-card-content>
            <div *ngFor="let material of task_materials; let m = index">
                <div class="task-card-content" *ngIf="task_materials">
                    <h3 class="text-info">{{material.material_name}}</h3>
                    <ion-list no-padding>
                        <ion-item no-padding>
                            <p style="font-weight:bold">Supplier:
                                {{material.supplier.name}}
                            </p>
                            <p>
                                <button ion-button icon-left clear medium
                                        class="phoneNum"
                                        (click)="callPhone(material.supplier.phone)">
                                    {{material.supplier.phone}}
                                </button>
                            </p>
                            <div>{{material.supplier.address}}</div>
                            <div>{{material.supplier.city}},
                                {{material.supplier.state}}&nbsp;{{material.supplier.zip}}
                            </div>
                        </ion-item>
                    </ion-list>
                </div>
            </div>
            <div class="task-card-content equip-center"
                 *ngIf="task_materials.length === 0">No
                Materials Specified
            </div>
        </ion-card-content>
    </ion-card>
</ion-content>





