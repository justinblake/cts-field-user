import {Injectable} from '@angular/core';
import {Platform} from 'ionic-angular';
import 'rxjs/add/operator/map';
import {ApiService} from './api-service';
//import {StorageService} from './storage-service';
import {UserManager} from './user-manager';
import {Utils} from '../utils/utils';


@Injectable()
export class ConversionManager {


    currentUser: any;
    currentTask: any;
    tomorrowsTask: any;
    taskStatuses: any = {};
    badgeNumber: any = 0;
    holdObject: any = {};
    hasToken: any;

    months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];


    constructor(public userMgr: UserManager,
                public apiService: ApiService,
                private platform: Platform,
                private utils: Utils) {
    }

    secondsToTime(seconds) {
        seconds = Number(seconds);
        let h = Math.floor(seconds / 3600);
        let m = Math.floor(seconds % 3600 / 60);
        let s = Math.floor(seconds % 3600 % 60);
        return {
            hour: h,
            min: m,
            sec: s
        };
    }

    convertDate(date) {
        let inMonth = date[5] + '' + date[6];
        let monthSpelled = this.months[parseInt(inMonth) - 1];
        let day = '';
        if (date[8] === '0') {
            day = date[9];
        } else {
            day = date[8] + '' + date[9];
        }
        return monthSpelled + ' ' + day + ', ' + date[0] + '' + date[1] + date[2] + '' + date[3];
    }

    convertDateTime(date) {
        let interimTime = new Date(date);
        let myZone = interimTime.getTimezoneOffset();
        let year = interimTime.getFullYear();
        let month = interimTime.getMonth();
        let day = interimTime.getUTCDate();
        let hour = interimTime.getUTCHours() - (myZone / 60);
        let minute = interimTime.getUTCMinutes();
        let seconds = interimTime.getUTCSeconds();
        let adjustTimezone = new Date(Date.UTC(year, month, day, hour, minute, seconds));
        let timeZero = adjustTimezone.setHours(0, 0, 0, 0);
        return new Date(timeZero).toISOString().slice(0, 10);
    }

    convertTimeToT(time) {
        let newYear = time.slice(0, 10);
        let newTime = time.slice(11);
        return newYear + 'T' + newTime;
    }


}
